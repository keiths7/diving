function registerScroll(){myScroll=new IScroll("#maskcontent",{scrollX:!0,scrollY:!1,mouseWheel:!0,momentum:!1,snap:!0}),myScroll.on("scrollEnd",function(){curpage=myScroll.currentPage.pageX+1,curpage>imgcount||($("#download").text(curpage+"/"+imgcount),displayImage($("#scroller li").children("div").eq(curpage-1)))})}function imgClick(){var o=this;initMask(o),$("#mask").animate({top:"0%"},"200",function(){}),pushHistory()}function pushHistory(){var o=location.href.indexOf("#SEE")>-1?location.href:location.href+"#SEE",i={title:"see large image",url:o,otherkey:""};window.history.pushState(i,"",o),window.addEventListener("popstate",destoryPowPoint,!1)}function destoryPowPoint(){$("#mask").animate({top:"100%"},"200",function(){var o=location.href.indexOf("#SEE")>-1?location.protocol+"//"+location.host+location.pathname:location.href;window.history.replaceState({},"",o)}),window.removeEventListener("popstate",destoryPowPoint,!1)}function initMask(o){var i=$(".row.images").find(".ui.image");imgcount=i.length,$(i).each(function(){$("#imgul").append('<li><div  data-img="'+$(this).data("img")+'" ><div class="loader-wrap" ><div class="ui active inline loader"></div></div></div></li>')}),$("#scroller li").css({width:100/imgcount+"%"}),$("#scroller").css({width:100*imgcount+"%"}),registerScroll();var n=i.index($(o));myScroll.goToPage(n,0,0);var t=myScroll.currentPage.pageX;displayImage($("#scroller li").children("div").eq(t))}function setImgSrc(o){var i=new Image;i.onload=function(){i.onload=null,setTimeout(function(){$(o).get(0).src=$(o).data("src")},1e3)},console.log($(o).data("src")),i.src=$(o).data("src")}function displayImage(o){var i=$(o).data("img");if(i){var n=new Image;n.onload=function(){n.onload=null,$(o).css({backgroundImage:"url("+i+")"}),$(o).text("")},n.src=i}}function stopEventBubble(o){var i=o||window.event;i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,o.preventDefault()}$(".ui.rating").rating(),$(".description.p70.column").on("click",".more",function(){$(this).prev().toggleClass("expand")}),$(".ui.left.arrow").on("click",function(){myScroll.prev()}),$(".ui.right.arrow").on("click",function(){myScroll.next()});var myScroll,imgcount=0;$(".row.images").on("click",".ui.image",imgClick),$("#pptclose").on("click",destoryPowPoint);